<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Everywhere</title>
    <style>
        body {
            background-color: #c0c1b8;
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            text-align: center;
        }
        .logo {
            display: block;
            margin: 0 auto;
            max-width: 200px;
            height: auto;
        }
        .caption {
            text-align: center;
            margin: 20px auto;
            font-size: 1.2em;
            max-width: 80px;
        }
        table {
            width: 100%;
            table-layout: fixed;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 1px;
            text-align: left;
            width: 33.33%;
            height: 40px; /* Fixed height for all cells */
        }
        th {
            background-color: #f2f2f2;
            text-align: center;
        }
        .row-header {
            text-align: center;
        }
        .cell-content {
            width: 100%;
            height: 100%;
            overflow: auto;
            white-space: nowrap;
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .logo {
                max-width: 150px;
            }
            .caption {
                font-size: 1em;
                max-width: 100%;
            }
            th, td {
                padding: 8px;
                height: 80px; /* Slightly smaller height for mobile */
            }
        }
    </style>
</head>
<body>
    <script type="module">
        import init, { verify_proof, verify_proof_sp1, ProofMode } from './pkg/snark_bn254_verifier.js';

        async function initializeWasm() {
            await init();
            // generated by the "groth16 worker" in https://github.com/S1nus/crs-server/
            let cleaned = await fetch('http://163.172.177.103/groth16_proof');
            let text = await cleaned.text();
            let result = await verify_proof(text, ProofMode.Groth16);
            console.log("result: ");
            console.log(result);
            if (result) {
                document.getElementById("sync-status").innerHTML = "Done synchronizing!";
                document.getElementById("sync-status").style = "color: green;";
            } else {
                document.getElementById("sync-status").innerHTML = "Failed :(";
                document.getElementById("sync-status").style = "color: red;";
            }

            let local_header = await fetch("http://163.172.177.103/groth16_header");
            let local_header_parsed = await local_header.json();
            let local_header_height = local_header_parsed.height;
            let local_header_hash = local_header_parsed.hash;
            document.getElementById("local-head-height").innerHTML = local_header_height;
            document.getElementById("local-head-hash").innerHTML = local_header_hash;

            let net_header = await fetch("http://163.172.177.103/net_head");
            let net_header_parsed = await net_header.json();
            let net_header_height = net_header_parsed.height;
            let net_header_hash = net_header_parsed.hash;
            document.getElementById("net-head-height").innerHTML = net_header_height;
            document.getElementById("net-head-hash").innerHTML = net_header_hash;
        }

        initializeWasm().then(() => {console.log("initialized");});

        /*initializeWasm().then(() => {
            document.getElementById('verifyGroth16').addEventListener('click', verifyGroth16WithSP1);
       
            /*fetch('myproof.json')
                .then(response => response.text())
                .then(data => {
                    let proof = JSON.parse(data);
                    let proofString = JSON.stringify(proof);
                    console.log(proofString);
             cleaned

        });*/
    </script>
    <div class="container">
        <img src="celestia-logo.png" alt="Logo" class="logo">
        <p id="sync-status">Syncing...</p>
        <table>
            <tr>
                <th></th>
                <th>Height</th>
                <th>Hash</th>
            </tr>
            <tr>
                <td class="row-header">Genesis</td>
                <td>1</td>
                <td><div class="cell-content">6BE39EFD10BA412A9DB5288488303F5DD32CF386707A5BEF33617F4C43301872</div></td>
            </tr>
            <tr>
                <td class="row-header">Local Head</td>
                <td><div class="cell-content" id="local-head-height">---</div></td>
                <td><div class="cell-content" id="local-head-hash">---</div></td>
            </tr>
            <tr>
                <td class="row-header">Network Head</td>
                <td><div class="cell-content" id="net-head-height">---</div></td>
                <td><div class="cell-content" id="net-head-hash">---</div></td>
            </tr>
        </table>
    </div>
</body>
</html>
